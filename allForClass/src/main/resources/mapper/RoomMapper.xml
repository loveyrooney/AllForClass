<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.chunjae.allforclass.dao.RoomMapper">

    <insert id="insert" parameterType="hashmap" useGeneratedKeys="true" keyProperty="id" keyColumn="infoId">
        insert lecture lecture(lid)
        values (#{dto.lid})
    </insert>
    <insert id="subinsert" parameterType="hashmap">
        insert into ref(refpath,refid)
        values
        <foreach collection="filenames" item="item"
                 separator=",">
            (
            #{item}
            , #{id}
            )
        </foreach>

    </insert>

    <select id="detailref" resultType="com.chunjae.allforclass.dto.RefDTO" parameterType="int">
        SELECT refpath
        FROM ref r INNER JOIN lecture l
        ON r.lid = l.lid
        WHERE l.lid = ${lid}
<!--        SELECT lid-->
<!--        (select group_concat(filename) as filenames-->
<!--        FROM ref-->
<!--        WHERE ref.refid = lecture.lid) as filenames-->
<!--        FROM lecture-->
    </select>

</mapper>